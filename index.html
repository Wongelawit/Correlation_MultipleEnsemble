<!DOCTYPE html>
<html>
  <head>
    <link rel="icon" href="img/VCL_favicon.png">
    <title>Numerosity Task</title>

    <script src="jspsych-6.0.5/jspsych.js"></script>
    <script src="jspsych-6.0.5/plugins/jspsych-html-keyboard-response.js"></script>
    <script src="jspsych-6.0.5/plugins/jspsych-image-keyboard-response.js"></script>
    <script src="jspsych-6.0.5/plugins/jspsych-multiple-ensembles-grid.js"></script>
    <link href="jspsych-6.0.5/css/jspsych.css" rel="stylesheet" type="text/css"></link>

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

  </head>

  <style>

    img {
      display: block;
      margin-left: auto;
      margin-right: auto;
    }

    body {
      height: 100vh;
      margin: 0;
      position: relative;
    }

    #center {
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }

  </style>

  <body>
    <div id = "center">
    <h1>Set Condition for <b>Numerosity Task</b></h1>

    <span style="display: block; background-color: #d0d5db">
      <div id = "feedback"><p><h5>Select color from dropdown.</h5></p></div>
    </span>
      
    <p>
    <p>  

    <input class="form-check-input" type="checkbox" value="" id="defaultCheck1" >
    <label class="form-check-label" for="defaultCheck1">
      Run shortened version (for testing)
    </label>

    <div class="form-row" style="margin: 20px">
      <label for="subjectID_input">Subject ID:</label>
      <input type="text" class="form-control" id="subjectID_input" placeholder="12345" style="text-align: center">
    </div>

    <p>
    <p>

    <div class="btn-group" style="margin-top: 20px">

      <button class="btn btn-info btn-lg dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="width: 250px">
        Condition
      </button>

      <div class="dropdown-menu" aria-labelledby="dropdownMenu2" style="width: 250px">
        
          <a href="#" onclick="set_condition('BLUE');" style="text-align:center" class="dropdown-item" >Blue</a>
          <a href="#" onclick="set_condition('RED');" style="text-align:center" class="dropdown-item" >Red</a>
          <a href="#" onclick="set_condition('GREEN');" style="text-align:center" class="dropdown-item" >Green</a>
          <a href="#" onclick="set_condition('YELLOW');" style="text-align:center" class="dropdown-item" >Yellow</a>

      </div>

    </div>
    <p>
    <p>

    <input id = "start" type="button" onclick="" class="btn btn-success" style="display: none; width: 250px;" value = "S T A R T">
    </div>

  </body>
  <script = 'text/javascript'>

    // Helper to set condition given drop down input
    function set_condition(color){

      // Set feedback HTML
      document.getElementById("feedback").innerHTML = "<h5>Condition set to: " + 
                                                        `<font color = ${color}>` +
                                                        color + "</h5><p>";
 
      // Set URL for start
      document.getElementById("start").onclick = function () {

        let url = "numerositytask.html?color=" + color;

        // Check if want the shortened version or not
        let subject_id = document.getElementById("subjectID_input").value;
        let checked = document.getElementById("defaultCheck1").checked;

        if (checked){
          url += "&short=true";
        } else {
          url += "&short=false";
        }

        if (subject_id){
          url += "&subjectID=" + encodeURI(subject_id);
        } else {
          url += "&subjectID=testSubject";
        }

        location.href = url;
      };

      // Make button visible
      document.getElementById("start").style = "display:inline-block; width: 250px";

      console.log("====== Condition set to: " + color + "======");
    }

  </script>
  </html>
